{"openapi":"3.0.3","info":{"title":"Policy Service","description":"The policy service exposes HTTP API for executing policies.","version":"1.0"},"servers":[{"url":"http://localhost:8081","description":"Policy Server"}],"paths":{"/liveness":{"get":{"tags":["health"],"summary":"Liveness health","operationId":"health#Liveness","responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"},"example":{"service":"Veritatis impedit rerum recusandae eligendi in.","status":"Quibusdam quia deserunt officiis ipsa.","version":"Sapiente unde doloremque quae ullam qui optio."}}}}}}},"/policy/import":{"post":{"tags":["policy"],"summary":"ImportBundle policy","description":"Import a signed policy bundle.","operationId":"policy#ImportBundle","parameters":[{"name":"Content-Length","in":"header","allowEmptyValue":true,"schema":{"type":"integer","example":3235493602741321499,"format":"int64"},"example":8640060862314354968}],"responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"type":"string","example":"Qui et sit maiores architecto alias.","format":"binary"},"example":"Veritatis hic non aperiam nihil sint."}}},"403":{"description":"Forbidden response.","content":{"application/json":{"schema":{"type":"string","example":"Nesciunt labore voluptatibus.","format":"binary"},"example":"Similique autem."}}},"500":{"description":"Internal Server Error response.","content":{"application/json":{"schema":{"type":"string","example":"Quia et deserunt expedita facilis maiores.","format":"binary"},"example":"Et recusandae et exercitationem impedit."}}}}}},"/policy/{repository}/{group}/{policyName}/{version}/evaluation":{"get":{"tags":["policy"],"summary":"Evaluate policy","description":"Evaluate executes a policy with the given 'data' as input.","operationId":"policy#Evaluate#1","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"policies"},"example":"policies"},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"example"},"example":"example"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"},{"name":"x-evaluation-id","in":"header","description":"EvaluationID allows overwriting the randomly generated evaluationID","allowEmptyValue":true,"schema":{"type":"string","description":"EvaluationID allows overwriting the randomly generated evaluationID","example":"did:web:example.com"},"example":"did:web:example.com"},{"name":"x-cache-ttl","in":"header","description":"Policy result cache TTL in seconds","allowEmptyValue":true,"schema":{"type":"integer","description":"Policy result cache TTL in seconds","example":60,"format":"int64"},"example":60}],"requestBody":{"description":"Input data passed to the policy execution runtime.","required":true,"content":{"application/json":{"schema":{"type":"string","description":"Input data passed to the policy execution runtime.","example":"Qui delectus.","format":"binary"},"example":"Nulla eligendi labore."}}},"responses":{"200":{"description":"OK response.","headers":{"ETag":{"description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","schema":{"type":"string","description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","example":"Et non similique quo qui saepe."},"example":"Illum iste repellat sequi libero."}},"content":{"application/json":{"schema":{"type":"string","description":"Arbitrary JSON response.","example":"Quia blanditiis.","format":"binary"},"example":"Vitae praesentium ratione enim nihil sit explicabo."}}}}},"post":{"tags":["policy"],"summary":"Evaluate policy","description":"Evaluate executes a policy with the given 'data' as input.","operationId":"policy#Evaluate#2","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"policies"},"example":"policies"},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"example"},"example":"example"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"},{"name":"x-evaluation-id","in":"header","description":"EvaluationID allows overwriting the randomly generated evaluationID","allowEmptyValue":true,"schema":{"type":"string","description":"EvaluationID allows overwriting the randomly generated evaluationID","example":"did:web:example.com"},"example":"did:web:example.com"},{"name":"x-cache-ttl","in":"header","description":"Policy result cache TTL in seconds","allowEmptyValue":true,"schema":{"type":"integer","description":"Policy result cache TTL in seconds","example":60,"format":"int64"},"example":60}],"requestBody":{"description":"Input data passed to the policy execution runtime.","required":true,"content":{"application/json":{"schema":{"type":"string","description":"Input data passed to the policy execution runtime.","example":"Qui delectus.","format":"binary"},"example":"Quia dolor rem eius molestias."}}},"responses":{"200":{"description":"OK response.","headers":{"ETag":{"description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","schema":{"type":"string","description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","example":"Libero voluptas."},"example":"Praesentium rerum dignissimos aliquam cumque."}},"content":{"application/json":{"schema":{"type":"string","description":"Arbitrary JSON response.","example":"Quia blanditiis.","format":"binary"},"example":"Reprehenderit est."}}}}}},"/policy/{repository}/{group}/{policyName}/{version}/evaluation/did.json":{"get":{"tags":["policy"],"summary":"Evaluate policy","description":"Evaluate executes a policy with the given 'data' as input.","operationId":"policy#Evaluate","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"policies"},"example":"policies"},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"example"},"example":"example"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"},{"name":"x-evaluation-id","in":"header","description":"EvaluationID allows overwriting the randomly generated evaluationID","allowEmptyValue":true,"schema":{"type":"string","description":"EvaluationID allows overwriting the randomly generated evaluationID","example":"did:web:example.com"},"example":"did:web:example.com"},{"name":"x-cache-ttl","in":"header","description":"Policy result cache TTL in seconds","allowEmptyValue":true,"schema":{"type":"integer","description":"Policy result cache TTL in seconds","example":60,"format":"int64"},"example":60}],"requestBody":{"description":"Input data passed to the policy execution runtime.","required":true,"content":{"application/json":{"schema":{"type":"string","description":"Input data passed to the policy execution runtime.","example":"Qui delectus.","format":"binary"},"example":"Eveniet excepturi repellendus similique in mollitia voluptas."}}},"responses":{"200":{"description":"OK response.","headers":{"ETag":{"description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","schema":{"type":"string","description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","example":"Neque est dolore."},"example":"Nisi illum nulla sit in."}},"content":{"application/json":{"schema":{"type":"string","description":"Arbitrary JSON response.","example":"Quia blanditiis.","format":"binary"},"example":"Et eligendi molestiae."}}}}}},"/policy/{repository}/{group}/{policyName}/{version}/export":{"get":{"tags":["policy"],"summary":"ExportBundle policy","description":"Export a signed policy bundle.","operationId":"policy#ExportBundle","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"policies"},"example":"policies"},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"returnDID"},"example":"returnDID"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"}],"responses":{"200":{"description":"OK response.","headers":{"content-disposition":{"description":"Content-Disposition response header containing the name of the file.","schema":{"type":"string","description":"Content-Disposition response header containing the name of the file.","example":"Ex in enim in ab sed."},"example":"Non et ut nihil voluptate consequuntur sunt."},"content-length":{"description":"Content-Length response header.","schema":{"type":"integer","description":"Content-Length response header.","example":1591621059069473908,"format":"int64"},"example":3739954644411962621},"content-type":{"description":"Content-Type response header.","schema":{"type":"string","description":"Content-Type response header.","example":"Ut non molestiae veniam aut."},"example":"Et quis fugit ipsam tempora consequatur."}},"content":{"application/json":{"schema":{"type":"string","format":"binary"}}}}}}},"/policy/{repository}/{group}/{policyName}/{version}/key":{"get":{"tags":["policy"],"summary":"PolicyPublicKey policy","description":"PolicyPublicKey returns the public key in JWK format which must be used to verify a signed policy bundle.","operationId":"policy#PolicyPublicKey","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"policies"},"example":"policies"},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"returnDID"},"example":"returnDID"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"}],"responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"type":"string","example":"Quos autem aut in est.","format":"binary"},"example":"Accusamus ut explicabo."}}}}}},"/policy/{repository}/{group}/{policyName}/{version}/lock":{"delete":{"tags":["policy"],"summary":"Unlock policy","description":"Unlock a policy so it can be evaluated again.","operationId":"policy#Unlock","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"Dolores iusto corporis quos recusandae."},"example":"Earum esse."},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"Fugit non incidunt ut quidem doloremque."},"example":"Nam voluptate placeat fuga ex vero corporis."},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"Dolore voluptatem."},"example":"Cupiditate excepturi illum porro mollitia ducimus assumenda."},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"Porro earum error quia provident non."},"example":"Molestiae maxime."}],"responses":{"200":{"description":"OK response."}}},"post":{"tags":["policy"],"summary":"Lock policy","description":"Lock a policy so that it cannot be evaluated.","operationId":"policy#Lock","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"Esse est aspernatur quo adipisci numquam excepturi."},"example":"Praesentium sed quibusdam repudiandae."},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"Est et dolores unde."},"example":"Nobis in voluptas eius cupiditate."},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"Ipsam ipsa quod eveniet velit voluptatem eligendi."},"example":"Tenetur cumque itaque."},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"Provident sint."},"example":"Natus voluptas enim nulla aut aut et."}],"responses":{"200":{"description":"OK response."}}}},"/policy/{repository}/{group}/{policyName}/{version}/notifychange":{"post":{"tags":["policy"],"summary":"SubscribeForPolicyChange policy","description":"Subscribe for policy change notifications by registering webhook callbacks which the policy service will call.","operationId":"policy#SubscribeForPolicyChange","parameters":[{"name":"repository","in":"path","description":"Policy repository.","required":true,"schema":{"type":"string","description":"Policy repository.","example":"Ullam consequatur incidunt enim repellendus ullam occaecati."},"example":"Nemo tenetur."},{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"Laboriosam dolorum."},"example":"Ut aliquid pariatur et quo error."},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"Quia impedit."},"example":"In voluptatem provident deleniti repellendus officia ut."},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"Illum ab mollitia impedit."},"example":"Id quo consequatur fuga laborum enim."}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscribeForPolicyChangeRequestBody"},"example":{"subscriber":"elc","webhook_url":"http://bosco.com/sofia"}}}},"responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"type":"string","example":"Omnis id.","format":"binary"},"example":"Voluptas dolores sunt dolorem perspiciatis."}}}}}},"/readiness":{"get":{"tags":["health"],"summary":"Readiness health","operationId":"health#Readiness","responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"},"example":{"service":"Iure rerum non cumque sapiente laborum voluptas.","status":"Aut accusantium in.","version":"Culpa deserunt voluptatem culpa."}}}}}}},"/v1/policies":{"get":{"tags":["policy"],"summary":"ListPolicies policy","description":"List policies from storage with optional filters.","operationId":"policy#ListPolicies","parameters":[{"name":"locked","in":"query","description":"Filter to return locked/unlocked policies (optional).","allowEmptyValue":true,"schema":{"type":"boolean","description":"Filter to return locked/unlocked policies (optional).","example":true},"example":true},{"name":"rego","in":"query","description":"Include policy source code in results (optional).","allowEmptyValue":true,"schema":{"type":"boolean","description":"Include policy source code in results (optional).","example":true},"example":false},{"name":"data","in":"query","description":"Include policy static data in results (optional). ","allowEmptyValue":true,"schema":{"type":"boolean","description":"Include policy static data in results (optional). ","example":false},"example":false},{"name":"dataConfig","in":"query","description":"Include static data config (optional).","allowEmptyValue":true,"schema":{"type":"boolean","description":"Include static data config (optional).","example":false},"example":false}],"responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PoliciesResult"},"example":{"policies":[{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."}]}}}}}}}},"components":{"schemas":{"HealthResponse":{"type":"object","properties":{"service":{"type":"string","description":"Service name.","example":"Perspiciatis eos et in."},"status":{"type":"string","description":"Status message.","example":"Temporibus consequatur cupiditate aut consequuntur in animi."},"version":{"type":"string","description":"Service runtime version.","example":"Aspernatur ut ab nam quis repellendus."}},"example":{"service":"Est repudiandae nihil hic quaerat.","status":"Blanditiis quia.","version":"Mollitia repellendus consequuntur."},"required":["service","status","version"]},"PoliciesResult":{"type":"object","properties":{"policies":{"type":"array","items":{"$ref":"#/components/schemas/Policy"},"description":"JSON array of policies.","example":[{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."}]}},"example":{"policies":[{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."},{"data":"Quae et et unde.","dataConfig":"Dolore ducimus accusamus et voluptatibus cupiditate.","group":"Ut est ut molestias sint ipsam.","lastUpdate":4907765416681941118,"locked":true,"policyName":"Architecto id.","rego":"Aperiam aut odio dolorum.","repository":"Architecto iure est.","version":"At ut dolore."}]},"required":["policies"]},"Policy":{"type":"object","properties":{"data":{"type":"string","description":"Policy static data.","example":"Illo temporibus."},"dataConfig":{"type":"string","description":"Policy static data optional configuration.","example":"Nam atque."},"group":{"type":"string","description":"Policy group.","example":"Est debitis."},"lastUpdate":{"type":"integer","description":"Last update (Unix timestamp).","example":4196680023420667989,"format":"int64"},"locked":{"type":"boolean","description":"Locked specifies if the policy is locked or allowed to execute.","example":false},"policyName":{"type":"string","description":"Policy name.","example":"Quis qui perferendis provident corrupti rerum exercitationem."},"rego":{"type":"string","description":"Policy rego source code.","example":"Consequatur totam reiciendis molestiae itaque qui."},"repository":{"type":"string","description":"Policy repository.","example":"Iusto porro rerum qui."},"version":{"type":"string","description":"Policy version.","example":"Voluptas qui quisquam magnam aut."}},"example":{"data":"Aut quis ducimus est quisquam sapiente.","dataConfig":"Dignissimos molestiae ullam totam nihil.","group":"Placeat aliquid consectetur dignissimos ea id est.","lastUpdate":968056217340219173,"locked":true,"policyName":"Eum quia quibusdam qui earum.","rego":"Cum et quas.","repository":"Nihil incidunt.","version":"Quidem dolorem doloremque nostrum."},"required":["repository","group","policyName","version","locked","lastUpdate"]},"SubscribeForPolicyChangeRequestBody":{"type":"object","properties":{"subscriber":{"type":"string","description":"Name of the subscriber for policy.","example":"8yb","minLength":3,"maxLength":100},"webhook_url":{"type":"string","description":"Subscriber webhook url.","example":"http://ziemann.name/loraine.wilderman","format":"uri"}},"example":{"subscriber":"su5","webhook_url":"http://ankunding.biz/nora"},"required":["webhook_url","subscriber"]}}},"tags":[{"name":"policy","description":"Policy Service provides evaluation of policies through Open Policy Agent."},{"name":"health","description":"Health service provides health check endpoints."}]}