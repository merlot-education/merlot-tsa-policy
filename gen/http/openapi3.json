{"openapi":"3.0.3","info":{"title":"Policy Service","description":"The policy service exposes HTTP API for executing policies.","version":"1.0"},"servers":[{"url":"http://localhost:8081","description":"Policy Server"}],"paths":{"/liveness":{"get":{"tags":["health"],"summary":"Liveness health","operationId":"health#Liveness","responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"},"example":{"service":"Accusamus enim.","status":"Recusandae est rerum corrupti quia.","version":"Quam dolores architecto itaque."}}}}}}},"/policy/{group}/{policyName}/{version}/evaluation":{"get":{"tags":["policy"],"summary":"Evaluate policy","description":"Evaluate executes a policy with the given 'data' as input.","operationId":"policy#Evaluate#1","parameters":[{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"example"},"example":"example"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"},{"name":"x-evaluation-id","in":"header","description":"EvaluationID allows overwriting the randomly generated evaluationID","allowEmptyValue":true,"schema":{"type":"string","description":"EvaluationID allows overwriting the randomly generated evaluationID","example":"did:web:example.com"},"example":"did:web:example.com"},{"name":"x-cache-ttl","in":"header","description":"Policy result cache TTL in seconds","allowEmptyValue":true,"schema":{"type":"integer","description":"Policy result cache TTL in seconds","example":60,"format":"int64"},"example":60}],"requestBody":{"description":"Input data passed to the policy execution runtime.","required":true,"content":{"application/json":{"schema":{"type":"string","description":"Input data passed to the policy execution runtime.","example":"Molestias rerum sunt eaque.","format":"binary"},"example":"Dignissimos enim."}}},"responses":{"200":{"description":"OK response.","headers":{"ETag":{"description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","required":true,"schema":{"type":"string","description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","example":"Error et sunt maxime aperiam."},"example":"Et exercitationem perspiciatis quidem accusamus."}},"content":{"application/json":{"schema":{"type":"string","description":"Arbitrary JSON response.","example":"Dolores totam voluptatem.","format":"binary"},"example":"Molestiae fugiat harum quia corporis ullam natus."}}}}},"post":{"tags":["policy"],"summary":"Evaluate policy","description":"Evaluate executes a policy with the given 'data' as input.","operationId":"policy#Evaluate#2","parameters":[{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"example"},"example":"example"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"},{"name":"x-evaluation-id","in":"header","description":"EvaluationID allows overwriting the randomly generated evaluationID","allowEmptyValue":true,"schema":{"type":"string","description":"EvaluationID allows overwriting the randomly generated evaluationID","example":"did:web:example.com"},"example":"did:web:example.com"},{"name":"x-cache-ttl","in":"header","description":"Policy result cache TTL in seconds","allowEmptyValue":true,"schema":{"type":"integer","description":"Policy result cache TTL in seconds","example":60,"format":"int64"},"example":60}],"requestBody":{"description":"Input data passed to the policy execution runtime.","required":true,"content":{"application/json":{"schema":{"type":"string","description":"Input data passed to the policy execution runtime.","example":"Molestias rerum sunt eaque.","format":"binary"},"example":"Animi omnis minima fuga numquam."}}},"responses":{"200":{"description":"OK response.","headers":{"ETag":{"description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","required":true,"schema":{"type":"string","description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","example":"Ipsum explicabo assumenda delectus."},"example":"Rerum saepe dolores laborum odio."}},"content":{"application/json":{"schema":{"type":"string","description":"Arbitrary JSON response.","example":"Dolores totam voluptatem.","format":"binary"},"example":"Eos nemo repudiandae."}}}}}},"/policy/{group}/{policyName}/{version}/evaluation/did.json":{"get":{"tags":["policy"],"summary":"Evaluate policy","description":"Evaluate executes a policy with the given 'data' as input.","operationId":"policy#Evaluate","parameters":[{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"example"},"example":"example"},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"example"},"example":"example"},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"1.0"},"example":"1.0"},{"name":"x-evaluation-id","in":"header","description":"EvaluationID allows overwriting the randomly generated evaluationID","allowEmptyValue":true,"schema":{"type":"string","description":"EvaluationID allows overwriting the randomly generated evaluationID","example":"did:web:example.com"},"example":"did:web:example.com"},{"name":"x-cache-ttl","in":"header","description":"Policy result cache TTL in seconds","allowEmptyValue":true,"schema":{"type":"integer","description":"Policy result cache TTL in seconds","example":60,"format":"int64"},"example":60}],"requestBody":{"description":"Input data passed to the policy execution runtime.","required":true,"content":{"application/json":{"schema":{"type":"string","description":"Input data passed to the policy execution runtime.","example":"Molestias rerum sunt eaque.","format":"binary"},"example":"Dolorem aut accusantium."}}},"responses":{"200":{"description":"OK response.","headers":{"ETag":{"description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","required":true,"schema":{"type":"string","description":"ETag contains unique identifier of the policy evaluation and can be used to later retrieve the results from Cache.","example":"Dolor culpa."},"example":"Ad omnis possimus."}},"content":{"application/json":{"schema":{"type":"string","description":"Arbitrary JSON response.","example":"Dolores totam voluptatem.","format":"binary"},"example":"Cupiditate qui quo."}}}}}},"/policy/{group}/{policyName}/{version}/lock":{"delete":{"tags":["policy"],"summary":"Unlock policy","description":"Unlock a policy so it can be evaluated again.","operationId":"policy#Unlock","parameters":[{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"Iusto mollitia rerum quis ut et."},"example":"Ipsam est alias officiis."},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"Qui dolores natus qui doloremque voluptatem."},"example":"Omnis aut quas eos qui minima non."},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"Non consequuntur."},"example":"Aut in."}],"responses":{"200":{"description":"OK response."}}},"post":{"tags":["policy"],"summary":"Lock policy","description":"Lock a policy so that it cannot be evaluated.","operationId":"policy#Lock","parameters":[{"name":"group","in":"path","description":"Policy group.","required":true,"schema":{"type":"string","description":"Policy group.","example":"Eveniet voluptas rerum."},"example":"Facilis tempora dolor consectetur."},{"name":"policyName","in":"path","description":"Policy name.","required":true,"schema":{"type":"string","description":"Policy name.","example":"Consequatur aut ipsam."},"example":"Aut provident ducimus vero adipisci nemo."},{"name":"version","in":"path","description":"Policy version.","required":true,"schema":{"type":"string","description":"Policy version.","example":"Itaque laborum."},"example":"Quos saepe dolorum qui tenetur aut."}],"responses":{"200":{"description":"OK response."}}}},"/readiness":{"get":{"tags":["health"],"summary":"Readiness health","operationId":"health#Readiness","responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"},"example":{"service":"Voluptas ad corporis adipisci inventore ipsum.","status":"Recusandae dolorum nisi distinctio vitae ad.","version":"Perspiciatis voluptatem."}}}}}}},"/v1/policies":{"get":{"tags":["policy"],"summary":"ListPolicies policy","description":"List policies from storage with optional filters.","operationId":"policy#ListPolicies","parameters":[{"name":"locked","in":"query","description":"Filter to return locked/unlocked policies (optional).","allowEmptyValue":true,"schema":{"type":"boolean","description":"Filter to return locked/unlocked policies (optional).","example":true},"example":true},{"name":"rego","in":"query","description":"Include policy source code in results (optional).","allowEmptyValue":true,"schema":{"type":"boolean","description":"Include policy source code in results (optional).","example":true},"example":false},{"name":"data","in":"query","description":"Include policy static data in results (optional). ","allowEmptyValue":true,"schema":{"type":"boolean","description":"Include policy static data in results (optional). ","example":false},"example":true},{"name":"dataConfig","in":"query","description":"Include static data config (optional).","allowEmptyValue":true,"schema":{"type":"boolean","description":"Include static data config (optional).","example":true},"example":true}],"responses":{"200":{"description":"OK response.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PoliciesResult"},"example":{"policies":[{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."},{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."},{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."},{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."}]}}}}}}}},"components":{"schemas":{"HealthResponse":{"type":"object","properties":{"service":{"type":"string","description":"Service name.","example":"Aut officiis veritatis impedit rerum recusandae."},"status":{"type":"string","description":"Status message.","example":"In id quibusdam."},"version":{"type":"string","description":"Service runtime version.","example":"Deserunt officiis ipsa molestiae."}},"example":{"service":"Unde doloremque quae ullam.","status":"Optio nobis iure rerum non.","version":"Sapiente laborum."},"required":["service","status","version"]},"PoliciesResult":{"type":"object","properties":{"policies":{"type":"array","items":{"$ref":"#/components/schemas/Policy"},"description":"JSON array of policies.","example":[{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."},{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."},{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."},{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."}]}},"example":{"policies":[{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."},{"data":"Optio quia et laborum.","dataConfig":"In libero perspiciatis voluptatum ut soluta.","group":"Commodi nemo fugiat id praesentium accusantium expedita.","lastUpdate":9002532952206938167,"locked":false,"policyName":"Et aliquam sunt in et quia cum.","rego":"Error maxime quasi quia non voluptatibus error.","version":"Qui non quia."}]},"required":["policies"]},"Policy":{"type":"object","properties":{"data":{"type":"string","description":"Policy static data.","example":"Rerum asperiores nulla."},"dataConfig":{"type":"string","description":"Policy static data optional configuration.","example":"Tenetur rerum necessitatibus fugit."},"group":{"type":"string","description":"Policy group.","example":"Est impedit."},"lastUpdate":{"type":"integer","description":"Last update (Unix timestamp).","example":2958895584654309878,"format":"int64"},"locked":{"type":"boolean","description":"Locked specifies if the policy is locked or allowed to execute.","example":false},"policyName":{"type":"string","description":"Policy name.","example":"Sapiente architecto et enim omnis."},"rego":{"type":"string","description":"Policy rego source code.","example":"Neque et sed modi accusantium."},"version":{"type":"string","description":"Policy version.","example":"Consequatur ut suscipit."}},"example":{"data":"Vel saepe nisi et.","dataConfig":"Ut reiciendis fugit dolorum cupiditate.","group":"Occaecati quam tempora.","lastUpdate":8725218653039851118,"locked":false,"policyName":"Aut nobis repellendus quis rem.","rego":"Expedita ipsum minus ipsam.","version":"Harum voluptate et ut similique doloremque quis."},"required":["group","policyName","version","locked","lastUpdate"]}}},"tags":[{"name":"policy","description":"Policy Service provides evaluation of policies through Open Policy Agent."},{"name":"health","description":"Health service provides health check endpoints."}]}